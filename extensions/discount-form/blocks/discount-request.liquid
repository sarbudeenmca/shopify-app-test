<div class="discount-request-form">
  <h2>Request a Discount</h2>
  <p>
    Fill in the form below to request a discount on your selected product.
  </p>

  <form id="discountForm">
    <!-- Product Name -->
    <div class="form-group">
      <label for="product">Product Name</label>
      <input type="text" id="product" name="product" required>
    </div>

    <!-- Qty + Price same row -->
    <div class="form-row">
      <div class="form-group">
        <label for="quantity">Quantity</label>
        <input type="number" id="quantity" name="quantity" required>
      </div>
      <div class="form-group">
        <label for="price">Price</label>
        <input type="text" id="price" name="price" required>
      </div>
    </div>

    <!-- Comments -->
    <div class="form-group">
      <label for="comments">Comments</label>
      <textarea id="comments" name="comments" rows="4"></textarea>
    </div>

    <!-- Submit -->
    <button type="submit" class="discount-submit">
      Submit Request
    </button>

     <div id="toast" style="
    display:none;
    position:fixed;
    bottom:20px;
    left:50%;
    transform:translateX(-50%);
    background:#4caf50;
    color:white;
    padding:12px 20px;
    border-radius:6px;
    box-shadow:0 2px 6px rgba(0,0,0,0.2);
    font-family:sans-serif;
  ">
    Discount request submitted!
  </div>
  </form>
</div>

<script>
document.getElementById("discountForm").addEventListener("submit", async function(e) {
  e.preventDefault();

  const form = e.target;
  const data = {
    product: form.product.value,
    quantity: form.quantity.value,
    price: form.price.value,
    comments: form.comments.value
  };

  try {
    const res = await fetch("/apps/discount-request", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    if (res.ok) {
      // Show toast
      const toast = document.getElementById("toast");
      toast.style.display = "block";

      // Hide after 3 seconds
      setTimeout(() => {
        toast.style.display = "none";
      }, 3000);

      // Reset form
      form.reset();
    } else {
      alert("Failed to submit request");
    }
  } catch (err) {
    alert("Error submitting request");
    console.error(err);
  }
});
</script>


<style>
.discount-request-form {
  padding: 20px;
  border: 1px solid #ddd;
  border-radius: 10px;
  max-width: 500px;
  margin: 20px auto;
  font-family: inherit;
}

.discount-request-form h2 {
  margin-bottom: 8px;
  color: #333;
}

.discount-request-form p {
  margin-bottom: 20px;
  color: #666;
}

.discount-request-form .form-group {
  display: flex;
  flex-direction: column;
  margin-bottom: 15px;
}

.discount-request-form label {
  font-size: 14px;
  margin-bottom: 5px;
  color: #444;
}

.discount-request-form input,
.discount-request-form textarea {
  padding: 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  width: 100%;
  font-size: 14px;
}

.discount-request-form .form-row {
  display: flex;
  gap: 10px;
}

.discount-request-form .discount-submit {
  background: #0070f3;
  color: #fff;
  font-weight: 600;
  padding: 12px;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: background 0.2s ease;
}

.discount-request-form .discount-submit:hover {
  background: #005bb5;
}
</style>

{% schema %}
{
  "name": "Discount Request Form",
  "target": "section",
  "settings": []
}
{% endschema %}